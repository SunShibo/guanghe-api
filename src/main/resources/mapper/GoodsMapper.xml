<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.guanghe.api.dao.mallDao.GoodsDao">

    <sql id="limit">
        limit #{pageOffset}, #{pageSize}
    </sql>
    <select id="queryGoods" parameterType="int" resultType="com.guanghe.api.entity.mallBo.GoodsBo">
        SELECT * FROM gh_news_update_industry_information WHERE id = #{id}
    </select>
    <delete id="deleteGoods" parameterType="int">
        delete from mall_goods_type where id = #{id}
    </delete>
    <insert id="addGoods" parameterType="com.guanghe.api.entity.mallBo.GoodsBo">
        INSERT INTO gh_news_update_industry_information  SET name = #{name},
        price = #{price},stock = #{stock},goodsNo = #{goodsNo},
        weight = #{weight},introduceImgUrl = #{introduceImgUrl},state = #{state},brandId = #{brandId},goodsTypeId = #{goodsTypeId}
         ,followCount = #{followCount}, saleCount = #{saleCount},create_time = NOW(),
      create_news_user = #{createNewsUser}

    </insert>
    <update id="updateGoods" parameterType="com.guanghe.api.entity.mallBo.GoodsBo">
        UPDATE gh_news_update_industry_information  SET name = #{name},
        price = #{price},stock = #{stock},goodsNo = #{goodsNo},update_time = NOW(),
        weight = #{weight},introduceImgUrl = #{introduceImgUrl},state = #{state},brandId = #{brandId},goodsTypeId = #{goodsTypeId}
         ,followCount = #{followCount}, saleCount = #{saleCount}WHERE id = #{id}
    </update>

    <select id="queryGoodsInfoSort" parameterType="com.guanghe.api.entity.mallBo.GoodsResponseBo" resultType="com.guanghe.api.entity.mallBo.GoodsBo">
        select * from mall_goods g join mall_price_and_specification p on g.id=p.goods_id WHERE 1=1
        AND
        g.leave_id = #{leaveId}
        <if test="goodsTypeId!=null">
            AND
            g.goods_type_id =#{goodsTypeId}
        </if>
        <if test="brandId!=null">
            AND
            g.brand_id =#{brandId}
        </if>
        <if test="weightStatu==1">
            AND  g.weight &lt; 1
        </if>
        <if test="weightStatu==2">
            AND   g.weight &lt; 5 AND g.weight &gt;1
        </if>
        <if test="weightStatu==3">
            AND  g.weight  &gt;5
        </if>
        group by g.id
        <if test="sortStatu==1">
            ORDER BY p.price ASC
        </if>
        <if test="sortStatu==2">
            ORDER BY p.price DESC
        </if>
         <if test="sortStatu==3">
         ORDER  BY g.sale_count ASC
         </if>
        <if test="sortStatu==4">
        ORDER  BY g.sale_count DESC
    </if>
        <if test="sortStatu==5">
         ORDER BY g.follow_count ASC
    </if>
        <if test="sortStatu==6">
        ORDER BY g.follow_count DESC
    </if>
        <if test="sortStatu==7">
        ORDER BY g.create_time ASC
    </if>
        <if test="sortStatu==8">
        ORDER BY g.create_time DESC
    </if>
</select>

    <select id="queryHomeGoodsList"  resultType="com.guanghe.api.entity.mallBo.GoodsBo">
        SELECT * FROM mall_goods WHERE homeState=1  OR homeState =2
    </select>

</mapper>